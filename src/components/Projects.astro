---
import { Github, Folder, ArrowRight, ExternalLink } from 'lucide-react';
import { projects } from '../data/projects';
import SpotlightCard from './SpotlightCard';
---

<section id="projects" class="py-20 md:py-32 px-4 relative overflow-hidden">
  <div class="max-w-7xl mx-auto relative z-10">
    <div class="flex items-center justify-between mb-16">
      <h2 class="text-3xl md:text-5xl font-bold font-mono text-white">
        <span class="text-accent-500">./</span>Projects
      </h2>
      <div class="hidden md:block h-px bg-gray-800 flex-grow ml-8"></div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="projects-container">
      {projects.map((project, index) => (
        <div 
          class="project-card group relative bg-[#0f141c]/80 border border-gray-800 rounded-xl p-6 h-full overflow-hidden transition-all duration-300 hover:border-gray-700 scroll-animate backdrop-blur-sm"
          style={`animation-delay: ${index * 100}ms`}
        >
          {/* Spotlight Gradient */}
          <div 
            class="pointer-events-none absolute -inset-px opacity-0 transition duration-300 group-hover:opacity-100"
            style="background: radial-gradient(600px circle at var(--mouse-x, 0) var(--mouse-y, 0), rgba(168, 85, 247, 0.15), transparent 40%);"
          ></div>

          <div class="relative z-10 flex flex-col h-full">
            <div class="flex justify-between items-start mb-6">
              <div class="p-3 rounded-lg bg-[#1e293b]/50 border border-gray-700/50 text-accent-400 group-hover:text-accent-300 transition-colors">
                <project.icon size={28} />
              </div>
              <div class="flex gap-2">
                {project.link && project.link !== "#" && (
                  <a href={project.link} target="_blank" rel="noopener noreferrer" class="p-2 rounded-full bg-gray-800 text-gray-400 hover:text-white hover:bg-gray-700 transition-all border border-transparent hover:border-gray-600" aria-label={`Visit ${project.title} live site`}>
                    <ExternalLink size={18} />
                  </a>
                )}
                 <a href={`/projects/${project.id}`} class="p-2 rounded-full bg-gray-800 text-gray-400 hover:text-white hover:bg-gray-700 transition-all border border-transparent hover:border-gray-600" aria-label={`View ${project.title} details`}>
                  <ArrowRight size={18} />
                </a>
              </div>
            </div>

            <a href={`/projects/${project.id}`} class="block mb-4">
                 <h3 class="text-xl font-bold text-white group-hover:text-primary-400 transition-colors font-mono">{project.title}</h3>
            </a>
            
            <div class="flex flex-wrap gap-2 mt-auto">
              {project.tech.map((t) => (
                <span class="text-xs px-2 py-1 rounded bg-[#1e293b]/50 text-gray-300 border border-gray-700/50 font-mono">
                  {t}
                </span>
              ))}
            </div>

          </div>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .project-card:hover::before {
    opacity: 1;
  }

  .scroll-animate {
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.6s ease-out, transform 0.6s ease-out;
  }

  .scroll-animate.visible {
    opacity: 1;
    transform: translateY(0);
  }
</style>

<script>
  // Mouse movement effect for projects
  const container = document.getElementById("projects-container");
  
  if (container) {
    container.onmousemove = e => {
      for(const card of container.getElementsByClassName("project-card")) {
        const rect = card.getBoundingClientRect(),
              x = e.clientX - rect.left,
              y = e.clientY - rect.top;

        (card as HTMLElement).style.setProperty("--mouse-x", `${x}px`);
        (card as HTMLElement).style.setProperty("--mouse-y", `${y}px`);
      }
    };
  }

  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add('visible');
      }
    });
  }, observerOptions);

  document.querySelectorAll('.scroll-animate').forEach((el) => {
    observer.observe(el);
  });
</script>
